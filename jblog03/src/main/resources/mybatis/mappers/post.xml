<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="post">
	<select id='findById' resultType="postvo">
	<choose>
         <when test="category_no != null">
         <choose>
         <when test="no == null">
		  <![CDATA[
		SELECT p.*
FROM post p
INNER JOIN category c ON p.category_no = c.no
WHERE c.blog_id = #{blog_id } and p.category_no = #{category_no }
		]]>
         </when>
         </choose>
		  </when>
		  <otherwise>
		<![CDATA[
		SELECT p.*
		FROM post p
		INNER JOIN category c ON p.category_no = c.no
		WHERE c.blog_id = #{blog_id }
		]]>
		  
		</otherwise>
		</choose>
	</select>
	
	<select id='findByPost' resultType="postvo">
		<![CDATA[
		SELECT p.*
		FROM post p
		INNER JOIN category c ON p.category_no = c.no
		WHERE c.blog_id = #{blog_id } and p.category_no = #{category_no } and p.no = #{post_no }
		]]>
	</select>


	<insert id="insert" parameterType="postvo">
		<![CDATA[
		insert into post values(null, #{title }, #{contents }, #{category_no }, now())
		]]>
	</insert>


</mapper>